set -x EDITOR nvim
set -x PAGER bat
set -x MANPAGER "sh -c 'col -bx | bat -l man -p'"

set -g fish_greeting ''
set -x HOMEBREW_NO_ENV_HINTS 1

set -x XDG_CONFIG_HOME ~/.config
set -x FZF_DEFAULT_COMMAND 'fd --type f --strip-cwd-prefix --hidden --follow --exclude .git'
set -x FZF_DEFAULT_OPTS '
  --height 40%
  --layout=reverse
  --border=rounded
  --preview "bat --color=always --style=numbers --line-range=:500 {}"
  --preview-window=right:60%:wrap
  --bind="ctrl-u:preview-page-up,ctrl-d:preview-page-down"
'

{{- if not .oppreferred }}
set -x SSH_AUTH_SOCK /Users/joel/Library/Containers/com.maxgoedjen.Secretive.SecretAgent/Data/socket.ssh
{{- end }}

{{- if .cloudInstall }}
set -x K9S_CONFIG_DIR ~/.config/k9s
{{- end }}

# 1. Reset the PATH to the bare minimum system defaults.
set -gx PATH /usr/bin /bin /usr/sbin /sbin

# 2. Add Homebrew using its full path.
# We check for the executable at its known location and then run it.
if test -x /opt/homebrew/bin/brew
    eval (/opt/homebrew/bin/brew shellenv)
end

# 3. Prepend ASDF shims. This runs after Homebrew, so it becomes the first entry.
if test -z "$ASDF_DATA_DIR"
    set _asdf_shims "$HOME/.asdf/shims"
else
    set _asdf_shims "$ASDF_DATA_DIR/shims"
end

if test -d "$_asdf_shims"
    if not contains $_asdf_shims $PATH
        set -gx --prepend PATH $_asdf_shims
    end
end
set --erase _asdf_shims

# 4. Add any other custom paths to the end.
fish_add_path --append "$HOME/.lmstudio/bin"